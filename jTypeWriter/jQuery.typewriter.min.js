(function(b){b.fn.jTypewriter=function(d,c){this.queue(function(j){$this=jQuery(this);var f=b.meta?$this.data():{};$this.data("jTypewriter",b.extend({text:$this.html()},b.fn.jTypewriter.defaults,c,f,{target:$this}));var i=$this.data("jTypewriter");i.text=i.text.replace(/\&amp;/g,"&");var o=i.text.length;var h="";var l=[];d=(d=="type")?"type":"erase";var n=(d=="type")?-1:o-1;var g=false;var k=false;var e=false;m();function m(){if(d=="type"){n++;var q=i.text.substr(n,1)}else{if(d=="erase"){n--;var q=i.text.substr(n,1)}}switch(i.typeIn){case"phrases":l=[".","!","?"];break;case"words":l=[" "];break;case"custom":l=i.customChar;break}if(i.typeIn!="letters"){if(jQuery.inArray(q,l)==-1&&n!=o+1){e=true}else{e=false}}if(!i.typeInHTML){if(q=="<"){g=(d=="type")}if(q==">"){g=(d=="erase")}}if(!i.typeInASCII){if(!g&&q=="&"){k=(d=="type")}if(!g&&q==";"){k=(d=="erase")}}tempText=i.text.substr(0,n+1);if(d=="type"){addTempText=i.text.substr(n)}else{if(d=="erase"){addTempText=tempText}}if(g||k||e){if(d=="type"){if(g){addTempText=addTempText.slice(0,addTempText.indexOf(">")+1);g=false}else{if(k){addTempText=addTempText.slice(0,addTempText.indexOf(";")+1);k=false}else{if(e){myFunction=function(r){return((index=addTempText.indexOf(r))!=-1)?index:addTempText.length};var p=((minVal=Math.min.apply(Math,b.map(l,myFunction)))==-1)?o-1:minVal+1;addTempText=addTempText.slice(0,p);e=false}}}tempText=i.text.substr(0,n+addTempText.length);n=tempText.length-1}else{if(d=="erase"){if(g){addTempText=addTempText.substr(0,addTempText.lastIndexOf("<")+1);g=false}else{if(k){addTempText=addTempText.substr(0,addTempText.lastIndexOf("&")+1);k=false}else{if(e){myFunction=function(r){return((index=addTempText.lastIndexOf(r))!=-1)?index:-1};var p=((minVal=Math.max.apply(Math,b.map(l,myFunction)))==-1)?-1:minVal+1;addTempText=addTempText.substr(0,p);e=false}}}tempText=addTempText;n=tempText.length-1}}}if(i.outputFormat=="HTML"){i.target.html(tempText)}else{if(i.outputFormat=="plaintext"){i.target.text(tempText)}}if((n+1<o&&d=="type")||(n+1>0&&d=="erase")){setTimeout(m,i.speed)}else{if(i.onComplete){i.onComplete.call(i.target)}console.log("done");j()}}});return this};function a(c){if(window.console&&window.console.log){console.log(c)}}b.fn.jTypewriter.defaults={speed:50,typeIn:"letters",customChar:[""],outputFormat:"HTML",typeInHTML:false,typeInASCII:false,onComplete:function(){}}})(jQuery);